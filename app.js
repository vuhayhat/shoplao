const translations = {
  vi: {
    home: {
      title: "Ch√†o m·ª´ng ƒë·∫øn v·ªõi Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠ ƒêa Qu·ªëc Gia!",
      desc: `D·ª± √°n h·ªó tr·ª£ ƒëa ng√¥n ng·ªØ, AI ph√¢n t√≠ch s·∫£n ph·∫©m, qu·∫£n l√Ω shop c√° nh√¢n, thanh to√°n linh ho·∫°t v√† nhi·ªÅu t√≠nh nƒÉng hi·ªán ƒë·∫°i.`
    },
    shop: {
      title: "Trang c√° nh√¢n Shop",
      desc: "Xem th√¥ng tin shop, s·∫£n ph·∫©m, ƒë√°nh gi√° v√† chia s·∫ª m·∫°ng x√£ h·ªôi."
    },
    register: {
      title: "ƒêƒÉng k√Ω m·ªü Shop",
      desc: "T·∫°o t√†i kho·∫£n, ƒëƒÉng k√Ω shop, ch·ªù duy·ªát v√† qu·∫£n l√Ω c·ª≠a h√†ng ri√™ng."
    },
    products: {
      title: "Qu·∫£n l√Ω S·∫£n ph·∫©m",
      desc: "Th√™m, s·ª≠a, xo√° s·∫£n ph·∫©m, m√¥ t·∫£ ƒëa ng√¥n ng·ªØ, ch·ªânh s·ª≠a ·∫£nh b·∫±ng AI."
    },
    cart: {
      title: "Gi·ªè h√†ng & Thanh to√°n",
      desc: "H·ªó tr·ª£ nhi·ªÅu ph∆∞∆°ng th·ª©c thanh to√°n, theo d√µi ƒë∆°n h√†ng, giao h√†ng."
    },
    ai: {
      title: "Ph√¢n t√≠ch s·∫£n ph·∫©m b·∫±ng AI",
      desc: "AI t·∫°o m√¥ t·∫£, g·ª£i √Ω t·ª´ kho√° SEO, ph√¢n t√≠ch ·∫£nh, ch·∫•m ƒëi·ªÉm s·∫£n ph·∫©m."
    },
    statistic: {
      title: "Th·ªëng k√™ t·ªïng quan",
      desc: "Xem t·ªïng s·ªë ƒë∆°n, s·∫£n ph·∫©m ƒë√£ b√°n, thu nh·∫≠p, kh√°ch h√†ng v√† s·∫£n ph·∫©m b√°n ch·∫°y."
    }
  },
  en: {
    home: {
      title: "Welcome to the Multi-National E-Commerce Platform!",
      desc: `The project supports multi-language, AI product analysis, personal shop management, flexible payment, and more modern features.`
    },
    shop: {
      title: "Personal Shop Page",
      desc: "View shop info, products, ratings, and social sharing."
    },
    register: {
      title: "Register a Shop",
      desc: "Create an account, register a shop, wait for approval, and manage your store."
    },
    products: {
      title: "Product Management",
      desc: "Add, edit, delete products, multilingual descriptions, AI image editing."
    },
    cart: {
      title: "Cart & Payment",
      desc: "Support multiple payment methods, order tracking, delivery."
    },
    ai: {
      title: "AI Product Analysis",
      desc: "AI generates descriptions, SEO keyword suggestions, image analysis, product scoring."
    },
    statistic: {
      title: "Statistics Overview",
      desc: "View total orders, sold products, income, customers, and best-selling products."
    }
  },
  lo: {
    home: {
      title: "‡∫ç‡∫¥‡∫ô‡∫î‡∫µ‡∫ï‡ªâ‡∫≠‡∫ô‡∫Æ‡∫±‡∫ö‡∫™‡∫π‡ªà‡ªÅ‡∫û‡∫•‡∫î‡∫ü‡∫≠‡∫°‡∫û‡∫≤‡∫ô‡∫¥‡∫î‡∫≠‡∫¥‡∫ô‡ªÄ‡∫ï‡∫µ‡ªÄ‡∫ô‡∫±‡∫î‡∫´‡∫º‡∫≤‡∫ç‡∫ä‡∫≤‡∫î!",
      desc: `‡ªÇ‡∫Ñ‡∫á‡∫Å‡∫≤‡∫ô‡∫Æ‡∫≠‡∫á‡∫Æ‡∫±‡∫ö‡∫´‡∫º‡∫≤‡∫ç‡∫û‡∫≤‡∫™‡∫≤, AI ‡∫ß‡∫¥‡ªÄ‡∫Ñ‡∫≤‡∫∞‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤, ‡∫ö‡ªç‡∫•‡∫¥‡∫´‡∫≤‡∫ô‡∫Æ‡ªâ‡∫≤‡∫ô‡∫™‡ªà‡∫ß‡∫ô‡∫ï‡∫ª‡∫ß, ‡∫Å‡∫≤‡∫ô‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô‡∫´‡∫º‡∫≤‡∫ç‡∫Æ‡∫π‡∫ö‡ªÅ‡∫ö‡∫ö ‡ªÅ‡∫•‡∫∞‡∫≠‡∫∑‡ªà‡∫ô‡ªÜ.`
    },
    shop: {
      title: "‡ªú‡ªâ‡∫≤‡∫Æ‡ªâ‡∫≤‡∫ô‡∫™‡ªà‡∫ß‡∫ô‡∫ï‡∫ª‡∫ß",
      desc: "‡ªÄ‡∫ö‡∫¥‡ªà‡∫á‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡∫Æ‡ªâ‡∫≤‡∫ô, ‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤, ‡∫Å‡∫≤‡∫ô‡∫õ‡∫∞‡ªÄ‡∫°‡∫µ‡∫ô, ‡ªÅ‡∫•‡∫∞‡∫Å‡∫≤‡∫ô‡ªÅ‡∫ö‡ªà‡∫á‡∫õ‡∫±‡∫ô‡∫™‡∫∑‡ªà‡∫™‡∫±‡∫á‡∫Ñ‡∫ª‡∫°."
    },
    register: {
      title: "‡∫•‡∫ª‡∫á‡∫ó‡∫∞‡∫ö‡∫Ω‡∫ô‡ªÄ‡∫õ‡∫µ‡∫î‡∫Æ‡ªâ‡∫≤‡∫ô",
      desc: "‡∫™‡ªâ‡∫≤‡∫á‡∫ö‡∫±‡∫ô‡∫ä‡∫µ, ‡∫•‡∫ª‡∫á‡∫ó‡∫∞‡∫ö‡∫Ω‡∫ô‡∫Æ‡ªâ‡∫≤‡∫ô, ‡∫•‡ªç‡∫ñ‡ªâ‡∫≤‡∫≠‡∫∞‡∫ô‡∫∏‡∫°‡∫±‡∫î, ‡ªÅ‡∫•‡∫∞‡∫ö‡ªç‡∫•‡∫¥‡∫´‡∫≤‡∫ô‡∫Æ‡ªâ‡∫≤‡∫ô."
    },
    products: {
      title: "‡∫Å‡∫≤‡∫ô‡∫à‡∫±‡∫î‡∫Å‡∫≤‡∫ô‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤",
      desc: "‡ªÄ‡∫û‡∫µ‡ªà‡∫°, ‡ªÅ‡∫Å‡ªâ‡ªÑ‡∫Ç, ‡∫•‡∫∂‡∫ö‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤, ‡∫Ñ‡∫≥‡∫≠‡∫∞‡∫ó‡∫¥‡∫ö‡∫≤‡∫ç‡∫´‡∫º‡∫≤‡∫ç‡∫û‡∫≤‡∫™‡∫≤, ‡ªÅ‡∫Å‡ªâ‡ªÑ‡∫Ç‡∫Æ‡∫π‡∫ö‡∫û‡∫≤‡∫ö AI."
    },
    cart: {
      title: "‡∫Å‡∫∞‡∫ï‡ªà‡∫≤ & ‡∫Å‡∫≤‡∫ô‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô",
      desc: "‡∫Æ‡∫≠‡∫á‡∫Æ‡∫±‡∫ö‡∫ß‡∫¥‡∫ó‡∫µ‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô‡∫´‡∫º‡∫≤‡∫ç‡∫Æ‡∫π‡∫ö‡ªÅ‡∫ö‡∫ö, ‡∫ï‡∫¥‡∫î‡∫ï‡∫≤‡∫°‡∫Ñ‡∫≥‡∫™‡∫±‡ªà‡∫á, ‡∫Å‡∫≤‡∫ô‡∫à‡∫±‡∫î‡∫™‡∫ª‡ªà‡∫á."
    },
    ai: {
      title: "AI ‡∫ß‡∫¥‡ªÄ‡∫Ñ‡∫≤‡∫∞‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤",
      desc: "AI ‡∫™‡ªâ‡∫≤‡∫á‡∫Ñ‡∫≥‡∫≠‡∫∞‡∫ó‡∫¥‡∫ö‡∫≤‡∫ç, ‡ªÅ‡∫ô‡∫∞‡∫ô‡∫≥‡∫Ñ‡∫≥‡∫™‡∫≥‡∫Ñ‡∫±‡∫ô SEO, ‡∫ß‡∫¥‡ªÄ‡∫Ñ‡∫≤‡∫∞‡∫Æ‡∫π‡∫ö, ‡∫õ‡∫∞‡ªÄ‡∫°‡∫µ‡∫ô‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤."
    },
    statistic: {
      title: "‡∫™‡∫∞‡∫ñ‡∫¥‡∫ï‡∫¥‡∫û‡∫≤‡∫ö‡∫•‡∫ß‡∫°",
      desc: "‡ªÄ‡∫ö‡∫¥‡ªà‡∫á‡∫à‡∫≥‡∫ô‡∫ß‡∫ô‡∫Ñ‡∫≥‡∫™‡∫±‡ªà‡∫á, ‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤‡∫ó‡∫µ‡ªà‡∫Ç‡∫≤‡∫ç‡ªÑ‡∫î‡ªâ, ‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö, ‡∫•‡∫π‡∫Å‡∫Ñ‡ªâ‡∫≤ ‡ªÅ‡∫•‡∫∞‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤‡∫Ç‡∫≤‡∫ç‡∫î‡∫µ."
    }
  }
};

let demoCategories = [
  { name: "Th·ªùi trang", count: 2 },
  { name: "Gi√†y d√©p", count: 1 },
  { name: "Ph·ª• ki·ªán", count: 0 }
];
let demoProducts = [
  {
    name: "√Åo thun nam basic",
    img: "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=400&q=80",
    price: 199000,
    status: "ƒêang b√°n",
    category: "Th·ªùi trang"
  },
  {
    name: "Qu·∫ßn jeans n·ªØ",
    img: "https://images.unsplash.com/photo-1516762689617-f5e6b9cfd2c1?auto=format&fit=crop&w=400&q=80",
    price: 299000,
    status: "H·∫øt h√†ng",
    category: "Th·ªùi trang"
  },
  {
    name: "Gi√†y sneaker tr·∫Øng",
    img: "https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&w=400&q=80",
    price: 499000,
    status: "ƒêang b√°n",
    category: "Gi√†y d√©p"
  }
];

// Th√™m d·ªØ li·ªáu ƒë∆°n h√†ng m·∫´u
const demoOrders = [
  {
    id: 1,
    customer: 'Nguy·ªÖn VƒÉn A',
    items: [0, 2], // index s·∫£n ph·∫©m
    total: 199000 + 499000,
    status: 'ƒê√£ thanh to√°n',
    date: '2024-06-01'
  },
  {
    id: 2,
    customer: 'Tr·∫ßn Th·ªã B',
    items: [1],
    total: 299000,
    status: 'Ch·ªù thanh to√°n',
    date: '2024-06-02'
  }
];

let cart = [];

let currentLang = localStorage.getItem('lang') || navigator.language.slice(0,2) || 'vi';
if (!['vi','en','lo'].includes(currentLang)) currentLang = 'vi';

function setLang(lang) {
  currentLang = lang;
  localStorage.setItem('lang', lang);
  renderPage(currentPage);
}

let currentPage = 'home';

function navigate(page) {
  currentPage = page;
  renderPage(page);
}

function renderPage(page) {
  const t = translations[currentLang][page];
  let html = `<h2>${t.title}</h2><p>${t.desc}</p>`;
  if(page === 'shop') {
    html += `<div class="shop-banner" style="background:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=900&q=80') center/cover;height:180px;border-radius:8px;"></div>
      <div class="shop-profile">
        <div class="shop-avatar"><img src="https://i.imgur.com/0y0y0y0.png" alt="Shop Avatar"></div>
        <div><h3>ABC Shop</h3><p>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (4.9/5)</p></div>
      </div>
      <div class="shop-products" style="display:flex;gap:20px;margin:30px 0;flex-wrap:wrap;">`;
    demoProducts.forEach((p, idx) => {
      html += `<div class='product-card'>
        <img src='${p.img}' alt='${p.name}'>
        <h4>${p.name}</h4>
        <div class='price'>${p.price.toLocaleString()}‚Ç´</div>
        <div class='status${p.status !== "ƒêang b√°n" ? " soldout" : ""}'>${p.status}</div>
        <button onclick='addToCart(${idx})' ${p.status!=="ƒêang b√°n"?"disabled":''}>Mua ngay</button>
      </div>`;
    });
    html += `</div>`;
  }
  if(page === 'register') {
    html += `<form class="shop-register-form">
      <label>T√™n Shop <input type="text" placeholder="Nh·∫≠p t√™n shop"></label><br>
      <label>M√¥ t·∫£ <textarea placeholder="M√¥ t·∫£ shop"></textarea></label><br>
      <label>Logo <input type="file"></label><br>
      <label>Lo·∫°i h√†ng h√≥a <input type="text" placeholder="V√≠ d·ª•: Th·ªùi trang, ƒêi·ªán t·ª≠..."></label><br>
      <button type="submit">ƒêƒÉng k√Ω</button>
    </form>`;
  }
  if(page === 'products') {
    let tab = window.productTab || 'category';
    html += `<div style='display:flex;gap:12px;margin-bottom:18px;'>
      <button class='product-tab-btn' onclick='switchProductTab("category")' ${tab==='category'?'style="background:#00fff7;color:#18122B;"':''}>Danh m·ª•c s·∫£n ph·∫©m</button>
      <button class='product-tab-btn' onclick='switchProductTab("product")' ${tab==='product'?'style="background:#00fff7;color:#18122B;"':''}>S·∫£n ph·∫©m</button>
    </div>`;
    if(tab==='category') {
      html += `<form onsubmit='addCategory(event)' style='margin-bottom:14px;display:flex;gap:8px;align-items:center;'><input id='catName' type='text' placeholder='T√™n danh m·ª•c m·ªõi' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;'><button type='submit' style='background:#00fff7;color:#18122B;font-weight:700;border:none;padding:7px 18px;border-radius:6px;cursor:pointer;'>+ Th√™m danh m·ª•c</button></form>`;
      html += `<table style='width:100%;border-collapse:collapse;margin-top:10px;'>
        <thead><tr style='background:#e3eafc;'><th>T√™n danh m·ª•c</th><th>S·ªë s·∫£n ph·∫©m</th><th>H√†nh ƒë·ªông</th></tr></thead><tbody>`;
      demoCategories.forEach((c, idx) => {
        html += `<tr style='border-bottom:1px solid #eee;'>
          <td>${window.editCatIdx===idx?`<input id='editCatInput' value='${c.name}' style='padding:4px 8px;border-radius:4px;border:1.5px solid #00fff7;font-size:1rem;'>`:c.name}</td>
          <td>${c.count}</td>
          <td>
            ${window.editCatIdx===idx?`<button onclick='saveEditCat(${idx})' style='background:#00fff7;color:#18122B;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>L∆∞u</button> <button onclick='cancelEditCat()' style='background:#e53935;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>Hu·ª∑</button>`:
            `<button onclick='editCat(${idx})' style='background:#ffb300;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>S·ª≠a</button> <button onclick='deleteCat(${idx})' style='background:#e53935;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>Xo√°</button>`}
          </td>
        </tr>`;
      });
      html += `</tbody></table>`;
    } else {
      html += `<form onsubmit='addProduct(event)' style='margin-bottom:14px;display:flex;gap:8px;flex-wrap:wrap;align-items:center;'><input id='prodName' type='text' placeholder='T√™n s·∫£n ph·∫©m' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;'><input id='prodImg' type='text' placeholder='Link ·∫£nh' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;width:180px;'><input id='prodPrice' type='number' placeholder='Gi√°' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;width:100px;'><select id='prodCat' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;'><option value=''>Ch·ªçn danh m·ª•c</option>${demoCategories.map(c=>`<option value='${c.name}'>${c.name}</option>`)}</select><select id='prodStatus' style='padding:7px 12px;border-radius:6px;border:2px solid #ff00cc;font-size:1rem;'><option>ƒêang b√°n</option><option>H·∫øt h√†ng</option></select><button type='submit' style='background:#00fff7;color:#18122B;font-weight:700;border:none;padding:7px 18px;border-radius:6px;cursor:pointer;'>+ Th√™m s·∫£n ph·∫©m</button></form>`;
      html += `<table style='width:100%;border-collapse:collapse;margin-top:10px;'>
        <thead><tr style='background:#e3eafc;'><th>·∫¢nh</th><th>T√™n s·∫£n ph·∫©m</th><th>Gi√°</th><th>Danh m·ª•c</th><th>Tr·∫°ng th√°i</th><th>H√†nh ƒë·ªông</th></tr></thead><tbody>`;
        demoProducts.forEach((p, idx) => {
          html += `<tr style='border-bottom:1px solid #eee;'>
            <td><img src='${p.img}' alt='' style='width:60px;height:40px;object-fit:cover;border-radius:4px;'></td>
            <td>${window.editProdIdx===idx?`<input id='editProdName' value='${p.name}' style='padding:4px 8px;border-radius:4px;border:1.5px solid #00fff7;font-size:1rem;width:120px;'>`:p.name}</td>
            <td>${window.editProdIdx===idx?`<input id='editProdPrice' type='number' value='${p.price}' style='padding:4px 8px;border-radius:4px;border:1.5px solid #00fff7;font-size:1rem;width:80px;'>`:p.price.toLocaleString()+"‚Ç´"}</td>
            <td>${window.editProdIdx===idx?`<select id='editProdCat' style='padding:4px 8px;border-radius:4px;border:1.5px solid #00fff7;font-size:1rem;'>${demoCategories.map(c=>`<option value='${c.name}' ${c.name===p.category?'selected':''}>${c.name}</option>`)}</select>`:p.category||''}</td>
            <td>${window.editProdIdx===idx?`<select id='editProdStatus' style='padding:4px 8px;border-radius:4px;border:1.5px solid #00fff7;font-size:1rem;'><option ${p.status==='ƒêang b√°n'?'selected':''}>ƒêang b√°n</option><option ${p.status==='H·∫øt h√†ng'?'selected':''}>H·∫øt h√†ng</option></select>`:p.status}</td>
            <td>
              ${window.editProdIdx===idx?`<button onclick='saveEditProd(${idx})' style='background:#00fff7;color:#18122B;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>L∆∞u</button> <button onclick='cancelEditProd()' style='background:#e53935;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>Hu·ª∑</button>`:
              `<button onclick='editProd(${idx})' style='background:#ffb300;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>S·ª≠a</button> <button onclick='deleteProd(${idx})' style='background:#e53935;color:#fff;border:none;padding:4px 10px;border-radius:3px;cursor:pointer;'>Xo√°</button>`}
            </td>
          </tr>`;
        });
        html += `</tbody></table>`;
    }
  }
  if(page === 'cart') {
    if(demoOrders.length === 0) {
      html += `<div class='cart-demo'><p>Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o.</p></div>`;
    } else {
      html += `<table class='order-table'>
        <thead><tr><th>M√£ ƒë∆°n</th><th>Kh√°ch h√†ng</th><th>S·∫£n ph·∫©m</th><th>T·ªïng ti·ªÅn</th><th>Tr·∫°ng th√°i</th><th>Ng√†y</th></tr></thead><tbody>`;
      demoOrders.forEach(order => {
        let statusClass = order.status === 'ƒê√£ thanh to√°n' ? 'status-paid' : (order.status === 'Ch·ªù thanh to√°n' ? 'status-pending' : 'status-cancel');
        let statusIcon = order.status === 'ƒê√£ thanh to√°n' ? '‚úîÔ∏è' : (order.status === 'Ch·ªù thanh to√°n' ? '‚è≥' : '‚ùå');
        html += `<tr onclick='showOrderDetail(${order.id})'>
          <td>#${order.id}</td>
          <td>${order.customer}</td>
          <td>${order.items.map(i=>demoProducts[i].name).join(', ')}</td>
          <td>${order.total.toLocaleString()}‚Ç´</td>
          <td class='${statusClass}'>${statusIcon} ${order.status}</td>
          <td>${order.date}</td>
        </tr>`;
      });
      html += `</tbody></table>`;
    }
  }
  if(page === 'ai') {
    html += `<div class='ai-analyze-box' style='margin-top:24px;'>
      <h3 style='font-family:Orbitron,Arial,sans-serif;font-size:1.3rem;color:#00fff7;text-shadow:0 0 8px #ff00cc;'>Ch·ªçn ch·ª©c nƒÉng AI n·ªïi b·∫≠t</h3>
      <div style='display:flex;gap:14px;flex-wrap:wrap;margin-bottom:18px;'>
        <button class='ai-btn' onclick='renderAIResult("chatbot")'>üõçÔ∏è T∆∞ v·∫•n mua h√†ng th√¥ng minh</button>
        <button class='ai-btn' onclick='renderAIResult("search")'>üß† T√¨m ki·∫øm s·∫£n ph·∫©m t·ª± nhi√™n</button>
        <button class='ai-btn' onclick='renderAIResult("personalize")'>üéØ C√° nh√¢n h√≥a tr·∫£i nghi·ªám</button>
        <button class='ai-btn' onclick='renderAIResult("content")'>üìù T·∫°o n·ªôi dung t·ª± ƒë·ªông</button>
        <button class='ai-btn' onclick='renderAIResult("vision")'>üì∏ X·ª≠ l√Ω h√¨nh ·∫£nh</button>
        <button class='ai-btn' onclick='renderAIResult("translate")'>üí¨ D·ªãch t·ª± ƒë·ªông & ƒëa ng√¥n ng·ªØ</button>
        <button class='ai-btn' onclick='renderAIResult("operation")'>üì¶ T·ªëi ∆∞u v·∫≠n h√†nh & qu·∫£n l√Ω</button>
      </div>
      <div id='ai-result-box'></div>
    </div>`;
  }
  if(page === 'statistic') {
    const totalOrders = demoOrders.length;
    const soldProducts = demoOrders.reduce((sum, o) => sum + o.items.length, 0);
    const totalIncome = demoOrders.filter(o=>o.status==="ƒê√£ thanh to√°n").reduce((sum,o)=>sum+o.total,0);
    const customers = [...new Set(demoOrders.map(o=>o.customer))];
    const productCount = {};
    demoOrders.forEach(o=>o.items.forEach(i=>{productCount[i]=(productCount[i]||0)+1}));
    const bestSellers = Object.entries(productCount).sort((a,b)=>b[1]-a[1]).slice(0,3);
    html += `
    <div class='statistic-box'>
      <div class='statistic-item'><span class='icon'>üì¶</span><div><div class='value'>${totalOrders}</div><div class='label'>T·ªïng s·ªë ƒë∆°n</div></div></div>
      <div class='statistic-item'><span class='icon'>üí∞</span><div><div class='value'>${totalIncome.toLocaleString()}‚Ç´</div><div class='label'>T·ªïng doanh thu</div></div></div>
      <div class='statistic-item'><span class='icon'>üõí</span><div><div class='value'>${soldProducts}</div><div class='label'>S·∫£n ph·∫©m ƒë√£ b√°n</div></div></div>
    </div>
    <div class='statistic-box' style='flex-direction:column;gap:18px;'>
      <div><h3 style='margin-bottom:10px;'>Th·ªëng k√™ ng∆∞·ªùi d√πng</h3><div class='customer-list'>`;
    customers.forEach(c => {
      html += `<div class='customer-card'><span class='icon'>üë§</span><b>${c}</b></div>`;
    });
    html += `</div></div>
      <div><h3 style='margin-bottom:10px;margin-top:18px;'>Th·ªëng k√™ s·∫£n ph·∫©m b√°n ch·∫°y</h3><div class='bestseller-list'>`;
    bestSellers.forEach(([i,c]) => {
      html += `<div class='bestseller-card'><span class='icon'>üî•</span><b>${demoProducts[i].name}</b><span>ƒê√£ b√°n: ${c}</span></div>`;
    });
    html += `</div></div>
    </div>`;
  }
  document.getElementById('main-content').innerHTML = html;
}

function addToCart(idx) {
  cart.push(idx);
  currentPage = 'cart';
  renderPage('cart');
}

// H√†m xem chi ti·∫øt ƒë∆°n h√†ng
function showOrderDetail(orderId) {
  const order = demoOrders.find(o=>o.id===orderId);
  if(!order) return;
  let html = `<div class='order-detail'><h2>Chi ti·∫øt ƒë∆°n h√†ng #${order.id}</h2>`;
  html += `<div><b>Kh√°ch h√†ng:</b> ${order.customer}</div>`;
  html += `<div><b>Ng√†y ƒë·∫∑t:</b> ${order.date}</div>`;
  html += `<div><b>Tr·∫°ng th√°i:</b> ${order.status === 'ƒê√£ thanh to√°n' ? '‚úîÔ∏è' : (order.status === 'Ch·ªù thanh to√°n' ? '‚è≥' : '‚ùå')} <span class='${order.status === 'ƒê√£ thanh to√°n' ? 'status-paid' : (order.status === 'Ch·ªù thanh to√°n' ? 'status-pending' : 'status-cancel')}'>${order.status}</span></div>`;
  html += `<div><b>T·ªïng ti·ªÅn:</b> ${order.total.toLocaleString()}‚Ç´</div>`;
  html += `<div><b>S·∫£n ph·∫©m:</b><ul>`;
  order.items.forEach(i=>{
    const p = demoProducts[i];
    html += `<li>${p.name} - ${p.price.toLocaleString()}‚Ç´</li>`;
  });
  html += `</ul></div>`;
  html += `<button onclick="navigate('cart')">Quay l·∫°i danh s√°ch ƒë∆°n</button></div>`;
  document.getElementById('main-content').innerHTML = html;
}

// Kh·ªüi t·∫°o trang ƒë·∫ßu ti√™n
document.addEventListener('DOMContentLoaded', () => {
  renderPage(currentPage);
});

window.renderAIResult = function(type) {
  let html = '';
  if(type==="chatbot") {
    html = `<div class='ai-result'><h4>üõçÔ∏è T∆∞ v·∫•n mua h√†ng th√¥ng minh (AI Chatbot)</h4><p>V√≠ d·ª•: <i>"T√¥i c·∫ßn qu√† sinh nh·∫≠t cho n·ªØ, gi√° d∆∞·ªõi 500k"</i></p><div class='ai-demo-bot'><b>G·ª£i √Ω:</b> <span>Son m√¥i 450k, N∆∞·ªõc hoa mini 399k, V√≤ng tay b·∫°c 320k</span><br><b>H·ªèi v·ªÅ ƒë·ªïi tr·∫£:</b> <span>"S·∫£n ph·∫©m ƒë∆∞·ª£c ƒë·ªïi trong 7 ng√†y n·∫øu c√≤n nguy√™n tem."</span></div></div>`;
  } else if(type==="search") {
    html = `<div class='ai-result'><h4>üß† T√¨m ki·∫øm s·∫£n ph·∫©m b·∫±ng ng√¥n ng·ªØ t·ª± nhi√™n</h4><p>V√≠ d·ª•: <i>"T√¥i mu·ªën m·ªôt ƒë√¥i gi√†y th·ªÉ thao m√†u tr·∫Øng, nh·∫π v√† kh√¥ng th·∫•m n∆∞·ªõc"</i></p><div class='ai-demo-bot'><b>K·∫øt qu·∫£:</b> <span>Gi√†y Sneaker Tr·∫Øng UltraLight - 499k</span></div></div>`;
  } else if(type==="personalize") {
    html = `<div class='ai-result'><h4>üéØ C√° nh√¢n h√≥a tr·∫£i nghi·ªám ng∆∞·ªùi d√πng</h4><p>AI ph√¢n t√≠ch h√†nh vi, g·ª£i √Ω s·∫£n ph·∫©m li√™n quan, t·ª± ƒë·ªông thay ƒë·ªïi banner, s·∫£n ph·∫©m n·ªïi b·∫≠t theo t·ª´ng ng∆∞·ªùi d√πng.</p><div class='ai-demo-bot'><b>G·ª£i √Ω cho b·∫°n:</b> <span>√Åo thun nam basic, Tai nghe Bluetooth, ƒê·ªìng h·ªì th√¥ng minh</span></div></div>`;
  } else if(type==="content") {
    html = `<div class='ai-result'><h4>üìù T·∫°o n·ªôi dung t·ª± ƒë·ªông</h4><p>AI t·∫°o m√¥ t·∫£ s·∫£n ph·∫©m h·∫•p d·∫´n, b√†i vi·∫øt blog/SEO, email marketing, ti√™u ƒë·ªÅ khuy·∫øn m√£i.</p><div class='ai-demo-bot'><b>M√¥ t·∫£ s·∫£n ph·∫©m:</b> <span>"√Åo thun cotton tho√°ng m√°t, thi·∫øt k·∫ø tr·∫ª trung, ph√π h·ª£p m·ªçi ho·∫°t ƒë·ªông."</span></div></div>`;
  } else if(type==="vision") {
    html = `<div class='ai-result'><h4>üì∏ Hi·ªÉu & x·ª≠ l√Ω h√¨nh ·∫£nh (Gemini Vision)</h4><p>Nh·∫≠n di·ªán s·∫£n ph·∫©m trong ·∫£nh, t√¨m s·∫£n ph·∫©m t∆∞∆°ng t·ª±, ki·ªÉm duy·ªát ·∫£nh b√¨nh lu·∫≠n.</p><div class='ai-demo-bot'><b>·∫¢nh t·∫£i l√™n:</b> <img src='https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&w=120&q=80' style='height:40px;border-radius:6px;vertical-align:middle;'> <span>AI nh·∫≠n di·ªán: Gi√†y sneaker tr·∫Øng</span></div></div>`;
  } else if(type==="translate") {
    html = `<div class='ai-result'><h4>üí¨ D·ªãch t·ª± ƒë·ªông & h·ªó tr·ª£ ƒëa ng√¥n ng·ªØ</h4><p>D·ªãch n·ªôi dung s·∫£n ph·∫©m, tr·∫£ l·ªùi kh√°ch qu·ªëc t·∫ø b·∫±ng ng√¥n ng·ªØ c·ªßa h·ªç.</p><div class='ai-demo-bot'><b>V√≠ d·ª•:</b> <span>"√Åo thun nam basic" ‚Üí <i>"Basic men's T-shirt" (EN)</i> / <i>"‡ªÄ‡∫™‡∫∑‡ªâ‡∫≠‡∫ç‡∫∑‡∫î‡∫ú‡∫π‡ªâ‡∫ä‡∫≤‡∫ç" (Lao)</i></span></div></div>`;
  } else if(type==="operation") {
    html = `<div class='ai-result'><h4>üì¶ T·ªëi ∆∞u quy tr√¨nh v·∫≠n h√†nh & qu·∫£n l√Ω</h4><p>Tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ h√≥a ƒë∆°n, ƒë∆°n h√†ng, email kh√°ch, t√≥m t·∫Øt ph·∫£n h·ªìi, t·ª± ƒë·ªông t·∫°o b√°o c√°o s·∫£n ph·∫©m b√°n ch·∫°y.</p><div class='ai-demo-bot'><b>B√°o c√°o nhanh:</b> <span>Tu·∫ßn n√†y: 120 ƒë∆°n, 3 s·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t: √Åo thun, Gi√†y sneaker, Tai nghe</span></div></div>`;
  }
  document.getElementById('ai-result-box').innerHTML = html;
}

window.renderAIResultLocation = function() {
  const val = document.getElementById('ai-location').value;
  let result = '';
  if(val==='hanoi') result = 'H√† N·ªôi: Khu v·ª±c ƒë√¥ng d√¢n, s·ª©c mua l·ªõn, ph√π h·ª£p kinh doanh th·ªùi trang, ƒë·ªì gia d·ª•ng, ƒë·ªì ƒÉn nhanh.';
  if(val==='hochiminh') result = 'H·ªì Ch√≠ Minh: Trung t√¢m kinh t·∫ø, kh√°ch h√†ng tr·∫ª, th√≠ch h·ª£p s·∫£n ph·∫©m c√¥ng ngh·ªá, ph·ª• ki·ªán, d·ªãch v·ª• nhanh.';
  if(val==='danang') result = 'ƒê√† N·∫µng: Du l·ªãch ph√°t tri·ªÉn, n√™n kinh doanh ƒë·∫∑c s·∫£n, qu√† l∆∞u ni·ªám, d·ªãch v·ª• du l·ªãch.';
  if(val==='vientiane') result = 'Vi√™ng ChƒÉn: Th·ªã tr∆∞·ªùng m·ªõi n·ªïi, nhu c·∫ßu h√†ng ti√™u d√πng, th·ªùi trang, ƒëi·ªán t·ª≠ tƒÉng.';
  if(val==='savannakhet') result = 'Savannakhet: Kinh doanh th·ª±c ph·∫©m, h√†ng ti√™u d√πng, d·ªãch v·ª• v·∫≠n chuy·ªÉn ph√π h·ª£p.';
  document.getElementById('ai-location-result').innerHTML = `<p>${result}</p>`;
}

window.switchProductTab = function(tab) {
  window.productTab = tab;
  window.editCatIdx = undefined;
  window.editProdIdx = undefined;
  renderPage('products');
}

window.addCategory = function(e) {
  e.preventDefault();
  const name = document.getElementById('catName').value.trim();
  if(!name) return alert('Nh·∫≠p t√™n danh m·ª•c!');
  if(demoCategories.some(c=>c.name.toLowerCase()===name.toLowerCase())) return alert('Danh m·ª•c ƒë√£ t·ªìn t·∫°i!');
  demoCategories.push({name,count:0});
  renderPage('products');
}

window.editCat = function(idx) {
  window.editCatIdx = idx;
  renderPage('products');
}

window.saveEditCat = function(idx) {
  const val = document.getElementById('editCatInput').value.trim();
  if(!val) return alert('T√™n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!');
  if(demoCategories.some((c,i)=>c.name.toLowerCase()===val.toLowerCase()&&i!==idx)) return alert('Tr√πng t√™n!');
  demoCategories[idx].name = val;
  // c·∫≠p nh·∫≠t category cho s·∫£n ph·∫©m
  demoProducts.forEach(p=>{if(p.category===demoCategories[idx].name)p.category=val;});
  window.editCatIdx = undefined;
  renderPage('products');
}

window.cancelEditCat = function() {
  window.editCatIdx = undefined;
  renderPage('products');
}

window.deleteCat = function(idx) {
  if(!confirm('Xo√° danh m·ª•c n√†y?')) return;
  if(demoCategories[idx].count>0) return alert('Danh m·ª•c c√≤n s·∫£n ph·∫©m!');
  demoCategories.splice(idx,1);
  renderPage('products');
}

window.addProduct = function(e) {
  e.preventDefault();
  const name = document.getElementById('prodName').value.trim();
  const img = document.getElementById('prodImg').value.trim();
  const price = +document.getElementById('prodPrice').value;
  const category = document.getElementById('prodCat').value;
  const status = document.getElementById('prodStatus').value;
  if(!name||!img||!price||!category) return alert('ƒêi·ªÅn ƒë·ªß th√¥ng tin!');
  demoProducts.push({name,img,price,status,category});
  // tƒÉng count danh m·ª•c
  const cat = demoCategories.find(c=>c.name===category); if(cat) cat.count++;
  renderPage('products');
}

window.editProd = function(idx) {
  window.editProdIdx = idx;
  renderPage('products');
}

window.saveEditProd = function(idx) {
  const name = document.getElementById('editProdName').value.trim();
  const price = +document.getElementById('editProdPrice').value;
  const category = document.getElementById('editProdCat').value;
  const status = document.getElementById('editProdStatus').value;
  if(!name||!price||!category) return alert('ƒêi·ªÅn ƒë·ªß th√¥ng tin!');
  // c·∫≠p nh·∫≠t count danh m·ª•c n·∫øu ƒë·ªïi
  const oldCat = demoProducts[idx].category;
  if(oldCat!==category){
    const oldC = demoCategories.find(c=>c.name===oldCat); if(oldC) oldC.count--;
    const newC = demoCategories.find(c=>c.name===category); if(newC) newC.count++;
  }
  demoProducts[idx].name = name;
  demoProducts[idx].price = price;
  demoProducts[idx].category = category;
  demoProducts[idx].status = status;
  window.editProdIdx = undefined;
  renderPage('products');
}

window.cancelEditProd = function() {
  window.editProdIdx = undefined;
  renderPage('products');
}

window.deleteProd = function(idx) {
  if(!confirm('Xo√° s·∫£n ph·∫©m n√†y?')) return;
  // gi·∫£m count danh m·ª•c
  const cat = demoCategories.find(c=>c.name===demoProducts[idx].category); if(cat) cat.count--;
  demoProducts.splice(idx,1);
  renderPage('products');
} 